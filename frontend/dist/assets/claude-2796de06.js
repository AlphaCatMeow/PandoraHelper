import{u as e,j as a,I as t,T as n,B as s,a9 as i,R as l,r as o,m as r,n as c,U as d,V as m}from"./index-1d327fa3.js";import{o as u,P as x,D as h,b as j,c as p,d as k,s as y,T as f,S as g}from"./ShareModal-79469f3e.js";import{R as w,u as N}from"./RobotOutlined-b3428826.js";import{F as q}from"./index-ac0f5492.js";import{R as S,C as I}from"./row-eabaef0a.js";function C(){const{t:C}=e(),b=[{key:"email",title:C("token.email"),dataIndex:["account","email"],width:120,render:e=>a.jsx(t,{value:e,onClick:a=>u(e,C,a),readOnly:!0})},{key:"uniqueName",title:"Unique Name",dataIndex:"uniqueName",align:"center",width:120},{key:"password",title:C("token.password"),dataIndex:"password",align:"center",width:120},{key:"expiresAt",title:C("token.expiresAt"),dataIndex:"expiresAt",align:"center",width:120,render:e=>""==e?"未知":e},{key:"comment",title:C("token.comment"),dataIndex:"comment",align:"center",render:e=>a.jsx(n.Text,{style:{maxWidth:500},ellipsis:!0,children:e})},{title:C("token.action"),key:"operation",align:"center",render:(e,t)=>a.jsxs(s.Group,{children:[a.jsx(i,{title:"登录并跳转至对话",placement:"bottom",children:a.jsx(s,{icon:a.jsx(w,{}),type:"primary",onClick:()=>D(t)})}),a.jsx(s,{icon:a.jsx(l,{}),type:"primary",onClick:()=>B(t)}),a.jsx(x,{title:C("token.deleteConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>E(t),children:a.jsx(s,{icon:a.jsx(h,{}),type:"primary",loading:A==t.accountId+t.uniqueName,danger:!0})})]})}],v=j(),F=p(),[T,L]=o.useState(!1),O=N(),[R]=q.useForm(),V=q.useWatch("email",R),z=q.useWatch("uniqueName",R),[A,U]=o.useState(void 0),[W,K]=o.useState({formValue:{...k},title:C("token.edit"),show:!1,onOk:e=>{K((e=>({...e,show:!1})))},onCancel:()=>{K((e=>({...e,show:!1})))}});o.useEffect((()=>{R.setFieldValue("email",O.get("email"))}),[O]);const B=e=>{K({formValue:e,title:C("token.edit"),show:!0,onOk:(e,a)=>{F.mutate(e,{onSuccess:()=>{K((e=>({...e,show:!1})))},onSettled:()=>a(!1)})},onCancel:()=>{K((e=>({...e,show:!1})))}})},D=e=>{L(!0),r.info({content:"正在跳转至对话...",key:"chatLogin",duration:5}),y.chatLoginShare(e.uniqueName,e.password).then((e=>{e&&window.open(e,"_blank")})).finally((()=>{L(!1)}))},E=e=>{U(e.accountId+e.uniqueName),v.mutate(e,{onSettled:()=>{U(void 0)}})},{data:G}=c({queryKey:["shareList","claude",V,z],queryFn:()=>y.searchShare("claude",V,z)});return a.jsxs(d,{direction:"vertical",size:"large",className:"w-full",children:[a.jsx(m,{children:a.jsx(q,{form:R,children:a.jsxs(S,{gutter:[16,16],children:[a.jsx(I,{span:6,lg:6,children:a.jsx(q.Item,{label:C("token.email"),name:"email",className:"!mb-0",children:a.jsx(t,{})})}),a.jsx(I,{span:6,lg:6,children:a.jsx(q.Item,{label:"Unique Name",name:"uniqueName",className:"!mb-0",children:a.jsx(t,{})})}),a.jsx(I,{span:12,lg:12,children:a.jsxs("div",{className:"flex justify-end",children:[a.jsx(s,{onClick:()=>{R.resetFields()},children:C("token.reset")}),a.jsx(s,{type:"primary",className:"ml-4",onClick:()=>{R.validateFields().then((e=>{R.submit()}))},children:C("token.search")})]})})]})})}),a.jsx(m,{title:C("token.shareList"),children:a.jsx(f,{rowKey:e=>e.accountId+e.uniqueName,size:"small",scroll:{x:"max-content"},pagination:{pageSize:10},columns:b,dataSource:G,loading:T})}),a.jsx(g,{...W})]})}export{C as default};
