import{u as e,j as t,I as a,ae as n,af as i,T as s,B as r,aa as l,U as o,r as d,m as c,n as m,V as h,W as x,ab as u}from"./index-7bbe7027.js";import{o as k,P as p,D as y,b as j,c as g,d as f,T as w,S as C}from"./ShareModal-5d5c1002.js";import{R as I,u as N}from"./RobotOutlined-829de96a.js";import{s as S}from"./shareService-731b4d5c.js";import{F as q}from"./index-78d84a0f.js";import{R as b,C as v}from"./row-f3af5677.js";function L(){const{t:L}=e(),T=[{key:"email",title:L("token.email"),dataIndex:["account","email"],width:120,render:e=>t.jsx(a,{value:e,onClick:t=>k(e,L,t),readOnly:!0})},{key:"uniqueName",title:"Unique Name",dataIndex:"uniqueName",align:"center",width:120},{key:"password",title:L("token.password"),dataIndex:"password",align:"center",width:120},{title:"次数限制",key:"usageLimit",children:[{key:"4o-mini",title:"4o-mini",dataIndex:"gpt4oMiniLimit",align:"center",width:100,render:e=>-1==e?"无限制":e},{key:"gpt4o",title:"4o",dataIndex:"gpt4oLimit",align:"center",width:100,render:e=>-1==e?"无限制":e},{key:"gpt4",title:"gpt4",dataIndex:"gpt4Limit",align:"center",width:100,render:e=>-1==e?"无限制":e},{key:"o1",title:"o1",dataIndex:"o1Limit",align:"center",width:100,render:e=>-1==e?"无限制":e},{key:"o1-mini",title:"o1-mini",dataIndex:"o1MiniLimit",align:"center",width:100,render:e=>-1==e?"无限制":e}]},{key:"refreshEveryday",title:L("token.refreshEveryday"),dataIndex:"refreshEveryday",align:"center",width:120,render:e=>e?t.jsx(n,{}):t.jsx(i,{})},{key:"temporaryChat",title:L("token.temporaryChat"),dataIndex:"temporaryChat",align:"center",width:80,render:e=>e?t.jsx(n,{}):t.jsx(i,{})},{key:"expiresAt",title:L("token.expiresAt"),dataIndex:"expiresAt",align:"center",width:120,render:e=>""==e?"未知":e},{key:"shareToken",title:"Share Token",dataIndex:"shareToken",align:"center",width:120,render:e=>t.jsx(a,{value:e,onClick:t=>k(e,L,t),readOnly:!0})},{key:"comment",title:L("token.comment"),dataIndex:"comment",align:"center",render:e=>t.jsx(s.Text,{style:{maxWidth:500},ellipsis:!0,children:e})},{title:L("token.action"),key:"operation",align:"center",render:(e,a)=>t.jsxs(r.Group,{children:[t.jsx(l,{title:"登录并跳转至对话",placement:"bottom",children:t.jsx(r,{icon:t.jsx(I,{}),type:"primary",onClick:()=>H(a)})}),t.jsx(r,{icon:t.jsx(o,{}),type:"primary",onClick:()=>_(a)}),t.jsx(p,{title:L("token.deleteConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>J(a),children:t.jsx(r,{icon:t.jsx(y,{}),type:"primary",loading:D==a.accountId+a.uniqueName,danger:!0})})]})}],F=["uniqueName","usageLimit","expiresAt","comment","operation"],O=T.map((e=>e.key)),A=j(),E=g(),[V,W]=d.useState(!1),z=N(),[M]=q.useForm(),R=q.useWatch("email",M),U=q.useWatch("uniqueName",M),[K,B]=d.useState(F),[D,G]=d.useState(void 0),[P,Y]=d.useState({formValue:{...f},title:L("token.edit"),show:!1,onOk:e=>{Y((e=>({...e,show:!1})))},onCancel:()=>{Y((e=>({...e,show:!1})))}});d.useEffect((()=>{M.setFieldValue("email",z.get("email"))}),[z]);const _=e=>{Y({formValue:e,title:L("token.edit"),show:!0,onOk:(e,t)=>{E.mutate(e,{onSuccess:()=>{Y((e=>({...e,show:!1})))},onSettled:()=>t(!1)})},onCancel:()=>{Y((e=>({...e,show:!1})))}})},H=e=>{W(!0),c.info({content:"正在跳转至对话...",key:"chatLogin",duration:5}),S.chatLoginShare(e.uniqueName,e.password).then((e=>{e&&window.open(e,"_blank")})).finally((()=>{W(!1)}))},J=e=>{G(e.accountId+e.uniqueName),A.mutate(e,{onSettled:()=>{G(void 0)}})},{data:Q}=m({queryKey:["shareList","chatgpt",R,U],queryFn:()=>S.searchShare("chatgpt",R,U)}),X=T.map((e=>({...e,hidden:!K.includes(e.key)})));return t.jsxs(h,{direction:"vertical",size:"large",className:"w-full",children:[t.jsx(x,{children:t.jsx(q,{form:M,children:t.jsxs(b,{gutter:[16,16],children:[t.jsx(v,{span:6,lg:6,children:t.jsx(q.Item,{label:L("token.email"),name:"email",className:"!mb-0",children:t.jsx(a,{})})}),t.jsx(v,{span:6,lg:6,children:t.jsx(q.Item,{label:"Unique Name",name:"uniqueName",className:"!mb-0",children:t.jsx(a,{})})}),t.jsx(v,{span:12,lg:12,children:t.jsxs("div",{className:"flex justify-end",children:[t.jsx(r,{onClick:()=>{M.resetFields()},children:L("token.reset")}),t.jsx(r,{type:"primary",className:"ml-4",onClick:()=>{M.validateFields().then((e=>{M.submit()}))},children:L("token.search")})]})})]})})}),t.jsx(x,{title:L("token.shareList"),extra:t.jsx(u,{title:"abc",defaultChecked:!0,checkedChildren:"简洁",unCheckedChildren:"详细",onChange:e=>{B(e?[...F]:[...O])}}),children:t.jsx(w,{rowKey:e=>e.accountId+e.uniqueName,bordered:!0,size:"small",scroll:{x:"max-content"},pagination:{pageSize:10},columns:X,dataSource:Q,loading:V})}),t.jsx(C,{...P})]})}export{L as default};
