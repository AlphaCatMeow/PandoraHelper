import{u as e,j as a,I as t,T as s,B as n,aa as i,U as l,r as o,m as r,n as c,V as d,W as m}from"./index-7bbe7027.js";import{o as u,P as x,D as h,b as j,c as p,d as k,T as y,S as f}from"./ShareModal-5d5c1002.js";import{R as w,u as g}from"./RobotOutlined-829de96a.js";import{s as N}from"./shareService-731b4d5c.js";import{F as S}from"./index-78d84a0f.js";import{R as q,C as I}from"./row-f3af5677.js";function C(){const{t:C}=e(),b=[{key:"email",title:C("token.email"),dataIndex:["account","email"],width:120,render:e=>a.jsx(t,{value:e,onClick:a=>u(e,C,a),readOnly:!0})},{key:"uniqueName",title:"Unique Name",dataIndex:"uniqueName",align:"center",width:120},{key:"password",title:C("token.password"),dataIndex:"password",align:"center",width:120},{key:"expiresAt",title:C("token.expiresAt"),dataIndex:"expiresAt",align:"center",width:120,render:e=>""==e?"未知":e},{key:"comment",title:C("token.comment"),dataIndex:"comment",align:"center",render:e=>a.jsx(s.Text,{style:{maxWidth:500},ellipsis:!0,children:e})},{title:C("token.action"),key:"operation",align:"center",render:(e,t)=>a.jsxs(n.Group,{children:[a.jsx(i,{title:"登录并跳转至对话",placement:"bottom",children:a.jsx(n,{icon:a.jsx(w,{}),type:"primary",onClick:()=>D(t)})}),a.jsx(n,{icon:a.jsx(l,{}),type:"primary",onClick:()=>B(t)}),a.jsx(x,{title:C("token.deleteConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>E(t),children:a.jsx(n,{icon:a.jsx(h,{}),type:"primary",loading:A==t.accountId+t.uniqueName,danger:!0})})]})}],v=j(),F=p(),[T,L]=o.useState(!1),O=g(),[V]=S.useForm(),W=S.useWatch("email",V),z=S.useWatch("uniqueName",V),[A,R]=o.useState(void 0),[U,K]=o.useState({formValue:{...k},title:C("token.edit"),show:!1,onOk:e=>{K((e=>({...e,show:!1})))},onCancel:()=>{K((e=>({...e,show:!1})))}});o.useEffect((()=>{V.setFieldValue("email",O.get("email"))}),[O]);const B=e=>{K({formValue:e,title:C("token.edit"),show:!0,onOk:(e,a)=>{F.mutate(e,{onSuccess:()=>{K((e=>({...e,show:!1})))},onSettled:()=>a(!1)})},onCancel:()=>{K((e=>({...e,show:!1})))}})},D=e=>{L(!0),r.info({content:"正在跳转至对话...",key:"chatLogin",duration:5}),N.chatLoginShare(e.uniqueName,e.password).then((e=>{e&&window.open(e,"_blank")})).finally((()=>{L(!1)}))},E=e=>{R(e.accountId+e.uniqueName),v.mutate(e,{onSettled:()=>{R(void 0)}})},{data:G}=c({queryKey:["shareList","claude",W,z],queryFn:()=>N.searchShare("claude",W,z)});return a.jsxs(d,{direction:"vertical",size:"large",className:"w-full",children:[a.jsx(m,{children:a.jsx(S,{form:V,children:a.jsxs(q,{gutter:[16,16],children:[a.jsx(I,{span:6,lg:6,children:a.jsx(S.Item,{label:C("token.email"),name:"email",className:"!mb-0",children:a.jsx(t,{})})}),a.jsx(I,{span:6,lg:6,children:a.jsx(S.Item,{label:"Unique Name",name:"uniqueName",className:"!mb-0",children:a.jsx(t,{})})}),a.jsx(I,{span:12,lg:12,children:a.jsxs("div",{className:"flex justify-end",children:[a.jsx(n,{onClick:()=>{V.resetFields()},children:C("token.reset")}),a.jsx(n,{type:"primary",className:"ml-4",onClick:()=>{V.validateFields().then((e=>{V.submit()}))},children:C("token.search")})]})})]})})}),a.jsx(m,{title:C("token.shareList"),children:a.jsx(y,{rowKey:e=>e.accountId+e.uniqueName,size:"small",scroll:{x:"max-content"},pagination:{pageSize:10},columns:b,dataSource:G,loading:T})}),a.jsx(f,{...U})]})}export{C as default};
