import{u as e,O as s,r as a,j as t,T as o,I as n,P as i,B as r,Q as l,R as c,n as d,U as m,V as h}from"./index-1d327fa3.js";import{u,d as x,o as p,P as j,D as y,T as f,S as k}from"./ShareModal-79469f3e.js";import{a as w}from"./accountService-91a3b4c7.js";import{u as S,a as T,b as g,c as C,C as K,E as N,B as V,S as v,R as I,A as z}from"./AccountModal-29802286.js";import{F}from"./index-ac0f5492.js";import{R as L,C as O}from"./row-eabaef0a.js";function b(){const[b]=F.useForm(),{t:A}=e(),R=S(),W=T(),_=g(),q=C(),B=u(),E=s(),[G,M]=a.useState(-1),[P,Y]=a.useState(-1),D=F.useWatch("email",b),Q={id:void 0,email:"",accountType:"claude",password:"",refreshToken:"",accessToken:"",sessionKey:"",shared:0},[U,$]=a.useState({formValue:{id:void 0,sessionKey:"",email:"",accountType:"claude",password:"",refreshToken:""},title:"New",show:!1,onOk:(e,s)=>{e.id?W.mutate(e,{onSuccess:()=>{$((e=>({...e,show:!1,formValue:{...Q}})))},onSettled:()=>s(!1)}):R.mutate(e,{onSuccess:()=>{$((e=>({...e,show:!1,formValue:{...Q}})))},onSettled:()=>s(!1)})},onCancel:()=>{$((e=>({...e,show:!1,formValue:{...Q}})))}}),[H,J]=a.useState({formValue:{...x,shareType:"claude"},title:"New",show:!1,onOk:(e,s)=>{s(!0),B.mutate(e,{onSuccess:()=>{J((e=>({...e,show:!1})))},onSettled:()=>{s(!1)}})},onCancel:()=>{J((e=>({...e,show:!1})))}}),X=[{title:A("token.email"),dataIndex:"email",ellipsis:!0,align:"center",render:e=>t.jsx(o.Text,{style:{maxWidth:200},ellipsis:!0,children:e})},{title:A("token.password"),dataIndex:"password",align:"center",ellipsis:!0,render:e=>t.jsx(o.Text,{style:{maxWidth:200},ellipsis:!0,children:e})},{title:"Session Key",dataIndex:"sessionKey",align:"center",width:150,render:(e,s)=>s.sessionKey?t.jsx(n,{value:s.sessionKey,onClick:e=>p(s.sessionKey,A,e),readOnly:!0}):t.jsx(i,{color:"error",children:"Empty"})},{title:A("token.shareStatus"),dataIndex:"shared",align:"center",width:100,render:(e,s)=>1==s.shared?t.jsx(K,{twoToneColor:"#52c41a"}):t.jsx(N,{twoToneColor:"#fa8c16"})},{title:A("token.updateTime"),dataIndex:"updateTime",align:"center",width:200},{title:A("token.share"),key:"share",align:"center",render:(e,s)=>t.jsxs(r.Group,{children:[t.jsx(V,{count:s.shareList?.length,style:{zIndex:9},children:t.jsx(r,{icon:t.jsx(v,{}),onClick:()=>E({pathname:"/admin/share/claude",search:`?email=${s.email}`}),children:A("token.shareList")})}),t.jsx(r,{icon:t.jsx(l,{}),onClick:()=>ee(s)})]})},{title:A("token.action"),key:"operation",align:"center",render:(e,s)=>t.jsxs(r.Group,{children:[t.jsx(j,{title:A("common.refreshConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>{Y(s.id),q.mutate(s.id,{onSettled:()=>Y(void 0)})},children:t.jsx(r,{icon:t.jsx(I,{}),type:"primary",loading:P===s.id,children:A("common.refresh")},s.id)}),t.jsx(r,{onClick:()=>se(s),icon:t.jsx(c,{}),type:"primary"}),t.jsx(j,{title:A("common.deleteConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>{M(s.id),_.mutate(s.id,{onSuccess:()=>M(void 0)})},children:t.jsx(r,{icon:t.jsx(y,{}),type:"primary",loading:G===s.id,danger:!0})})]})}],{data:Z}=d({queryKey:["accounts","claude",D],queryFn:()=>w.searchAccountList(D,"claude")}),ee=e=>{J((s=>({...s,show:!0,title:A("token.share"),formValue:{...x,accountId:e.id,shareType:"claude"}})))},se=e=>{$((s=>({...s,show:!0,title:A("token.edit"),formValue:{...s.formValue,id:e.id,email:e.email,password:e.password,shared:e.shared,sessionKey:e.sessionKey}})))};return t.jsxs(m,{direction:"vertical",size:"large",className:"w-full",children:[t.jsx(h,{children:t.jsx(F,{form:b,children:t.jsxs(L,{gutter:[16,16],children:[t.jsx(O,{span:6,lg:6,children:t.jsx(F.Item,{label:A("token.email"),name:"email",className:"!mb-0",children:t.jsx(n,{})})}),t.jsx(O,{span:18,lg:18,children:t.jsxs("div",{className:"flex justify-end",children:[t.jsx(r,{onClick:()=>{b.resetFields()},children:A("token.reset")}),t.jsx(r,{type:"primary",className:"ml-4",children:A("token.search")})]})})]})})}),t.jsx(h,{title:A("token.accountList"),extra:t.jsx(m,{children:t.jsx(r,{type:"primary",onClick:()=>{$((e=>({...e,show:!0,title:A("token.createNew"),formValue:{id:void 0,email:"",password:"",sessionKey:"",accountType:"claude",shared:0,custom_type:"refresh_token",custom_token:""}})))},children:A("token.createNew")})}),children:t.jsx(f,{rowKey:"id",size:"small",scroll:{x:"max-content"},pagination:{pageSize:10},columns:X,dataSource:Z})}),t.jsx(z,{...U}),t.jsx(k,{...H})]})}export{b as default};
